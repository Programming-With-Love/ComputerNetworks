# ComputerNetworks

>## 大学课程《计算机网络》的配套资源笔记。

# 目录

 ### <a href="md/计算机网络体系结构.md">一.计算机网络体系结构</a>

 ### <a href="md/网络层详解.md">二.网络层详解</a>

 ### <a href="md/传输层&运输层详解.md">三.传输层/运输层详解</a>

 ### <a href="md/应用层详解.md">四.应用层详解</a>

 ### <a href="md/网络安全.md">五.网络安全详解</a>

# 正文

# 一.计算机网络体系结构

## 1.概念

 **计算机网络及其部件所应完成的功能的精确定义**. 体系结构是抽象的,实现则是具体的.

## 2.体系结构的具体实现

![img](https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F3c0a99cc-dd56-47d4-a171-51dc14b8c82a%2FUntitled.png?table=block&id=95157d52-6bd5-4a79-a171-8db8fb3a062d&width=1430&cache=v2)

## 3.OSI七层协议

开放系统互连参考模型(Open Systems Interconnection Reference Model) 简称OSI  由国际标准化组织成立.
“开放”是指只要遵循OSI标准,一个系统可以和位于世界上任何地方,也遵循这一标准的系统进行通信.

##  4.TCP/IP协议

TCP/IP协议是一个四层的体系结构,目前为止得到了最广泛的应用.

## 5.五层协议

在学习计算机网络原理时采取折中的方法,综合OSI和TCP/IP协议的优点,采用一种只有五层协议的原理体系结构.

## 6.应用层

### 	 协议

| 协议                                      | 名称             | 应用                           |
| ----------------------------------------- | ---------------- | ------------------------------ |
| DNS (Domain Name System)                  | 域名系统         | 域名到IP地址的转换             |
| WWW (World Wide Web)                      | 万维网           | 大规模的信息存储所　分布式应用 |
| HTTP (HyperText Transfer Protocol)        | 超文本传送协议   | 使用TCP进行传输数据            |
| SMTP (Simple Mail Transfer Protocol)      | 简单邮件传送协议 | 邮件发送                       |
| POP3 (Post Office Protocol POP)           | 邮局协议         | 邮件读取                       |
| FTP(FIle Transfer Protocol)               | 文件传送协议     | 传输文件                       |
| TELNET                                    | 远程终端协议     | 远程登陆                       |
| DHCP(Dynamic Host Configuration Protocol) | 动态主机配置协议 | 即插即用连网                   |
| RTP(Real-time Transport Protocol)         | 实时传输协议     | 传输多媒体数据                 |

### 	 作用
​		 **定义应用进程间的通信规则**,定义“**如何通过应用进程间的交互来完成特定的网络应用**”
### 	数据单元
​	**报文**

## 7.传输层/运输层

### 协议
1. TCP(传输控制协议)
   ​	提供面向连接的,可靠的数据传输服务.   单位是 : **报文段**
2. UDP(用户数据报协议)
   ​	提供无连接的,尽最大努力的数据传输服务  单位: **用户数据报**

### 单位
报文段(TCP)

用户数据报(UDP)

### 作用

**负责向两台主机中某两端口的进程之间通信提供通用的数据传输服务**．应用程序通过该服务传输应用层**报文**

### 功能

1. 复用：　多个应用层程序可以同时使用下面运输层的服务

2. 分用：　运输层把收到的消息分别交付给应用层中的相应进程．

## 网络层

### 协议

​		IP协议

### 作用

​	负责为分组交换机上的不同主机提供通信服务.

​	这一层将上一层运输层产生的 用户数据报/报文段 封装成 IP数据报.

### 任务

​		选择合适的路由,将源主机传输层传下来的分组,通过网络层中的路由器进行转发.最后到达目的主机.

## 8.数据链路层

### 作用:

​	将上一层网络层的IP数据报加入必要的控制信息封装成帧,从链路的一端传送到另一端

### 单位

​	帧(Frame)

## 9.物理层

### 	作用

​		在传输媒体上传送比特流. 将数据链路层中的帧的每个比特从;一个节点传输到另一个节点.

### 	单位

​	比特

## 10.数据传输过程



![数据传输过程](https://gitee.com/ShaoxiongDu/imageBed/raw/master/%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E8%BF%87%E7%A8%8B.png)

## 实体,协议.服务

### 实体:

​	表示任何可以发送或者接受数据的软硬件

### 协议:

​	控制两个对等实体进行通信的规则

​	在协议的控制下,两个对等实体间的通信使得能为上一层提供服务, 要实现本层协议,还需要使用下一层所提供的数据.

使用本层的服务的实体只能看到服务无法看到下面的协议,下面的协议对上边来说是透明的.好像不存在.

### 总结:

**协议是水平的, 服务是垂直的**

## 11.TCP/IP体系结构

### TCP/IP体系结构协议簇

![TCP/IP沙漏形状示意图](https://gitee.com/ShaoxiongDu/imageBed/raw/master/%E4%B8%8B%E8%BD%BD.png)
# 二.计算机网络-网络层详解

## 1.网络层概述

网络层关注的是如何将IP数据报从源主机沿着网络发送到目标主机。其具体步骤为将上一层传输层的报文段或者用户数据报添加必要的控制信息封装成IP数据报，并使用下一层数据链路层的服务将IP数据报发送给指定的主机。

## 2.网络层功能

1. ### 分组转发

   ​    当一个分组到达路由器的一条输出线路时，该路由器必须将该分组转发到适当的输出链路。所以，在路由器内部，需要有一个**转发表**。 在转发分组时，读取从IP数据报中首部的转发标识并在**转发表**中查询，其查询结果指出了该分组将被转发的路由器的链路接口。

2. ### 路由选择

   当分组从发送方转发到接收方时，网络层必须决定这些分组采用的路由或者路径，这就是**路由选择**。路由选择的结果就是**生成了供分组转发需要的转发表**

   其具体步骤为：  路由选择（人工/自动） ➡ 路由表  ➡  转发表

3.   ### 路由选择和分组转发的关系

![在这里插入图片描述](https://gitee.com/ShaoxiongDu/imageBed/raw/master/20190814154840851.jpg)

## 3.网络层提供的两种服务

1. ### 虚电路服务（Virtual-Circuit Network）

   面向连接的服务

   在发送数据时，先建立连接，即建立一条**虚电路**，保证双方通信所需要的网络资源。这样分组首部不需要填写完整的目标主机，只需要填写一条虚电路的编号，因此减少了分组的开销。

   ![虚电路](https://gitee.com/ShaoxiongDu/imageBed/raw/master/20210424215746.png)

2. ### 数据报服务(Datagram Network)

   面向无连接的服务

   网络在发送数据时不需要提前建立连接，每个分组都独立发送，都携带完整的目标主机地址。

   因为计算机网络的端系统是智能的，并且有相当强的计算能力和差错检测能力。所以在网络层向上只提供简单灵活，无连接，尽最大努力交付的数据报服务。也就是说，网络层不提供服务质量，是由运输层提供的。因特网的这种设计思想被称为“**端到端原则**”，将复杂的网络处理纠错置于网络边缘，将简单的尽最大努力的交付置于因特网核心。这样网络的造价降低，方式灵活。

![](https://gitee.com/ShaoxiongDu/imageBed/raw/master/20210424215838.png)

3. ### 虚电路和数据报对比

![](https://gitee.com/ShaoxiongDu/imageBed/raw/master/20210424215856.png)

## 4. IP协议（网际协议）

IP协议是TCP/IP体系中最主要的协议之一，与之配套的共有四个协议

- ARP: 地址解析协议 : 提供从IP地址到物理地址的映射服务，网络层使用下层链路层服务时使用

- RARP: 逆地址解析协议 : 提供从物理地址到IP地址的服务

- ICMP: 网际控制报文协议

- IGMP: 网际组管理协议

![在这里插入图片描述](https://gitee.com/ShaoxiongDu/imageBed/raw/master/20191228145928986.png)

ARP和RARP在IP协议的下方，因为IP协议要使用这两个协议，ICMP和IGMP在IP协议上方，因为这两个要使用IP协议。

## 5. IP地址

###　IP地址概念

在网络上的每一台主机都会被分配一个32位的唯一标识符

### 点分十进制记法

将32位的IP地址按8位一组分为四组，并转化为十进制，数字之间加.

![点分十进制记法](https://gitee.com/ShaoxiongDu/imageBed/raw/master/IP%E5%9C%B0%E5%9D%80.png)

### IP地址阶段

1. #### 分类编码

   IP地址::={<网络号>,<主机号>} （定长网络号）

​      好处:
- IP地址管理机构只需要分配网路号，主机号由单位自行分配。便于管理
- 路由器根据IP地址所在网络号进行转发，减小了路由器的转发表所占的空间以及查找路由表的时间

![](https://gitee.com/ShaoxiongDu/imageBed/raw/master/20210424215926.png)

2. #### 划分子网

   从主机号中借用不定长的若干位作为子网号

   IP地址::={<网络号>,<子网号>,<主机号>}

好处：

​     减少了分类编址中AB类地址的浪费，可以将其划分给多个组织使用

3. #### 无分类编址（CIDR） （正在使用）

​    IP地址::={<网络前缀>,<主机号>}

​    将32位IP地址划分为前边不定长的网络前缀，并且引入的32位的地址掩码，地址掩码中1 的个数表示表示IP地址中前

多少位为网络号。

对应分类编址中的默认地址掩码

| 分类编址 | 默认地址掩码  |
| -------- | ------------- |
| A类      | 255.0.0.0     |
| B类      | 255.255.0.0   |
| C类      | 255.255.255.0 |

斜线记法： 在IP地址后加入/数字 表示网络地址的个数 比如  192.168.1.1/20 表示前20位为网络前缀。

###　特殊的IP地址

![特殊的IP地址](https://gitee.com/ShaoxiongDu/imageBed/raw/master/image-20210424210008516.png)

## 5.物理地址

物理地址是数据链路层和物理层使用的地址，IP地址是网络层以及上层使用的地址

IP地址放到IP数据报的首部，物理地址放到数据链路层中MAC帧的首部。

## 6.ARP地址解析协议

###   目的：解决从IP地址到物理地址的动态映射问题

###   方法：每一个主机都动态维护一个ARP高速缓存（ARP Cache）,这个缓存中存放本局域网上各个主机的IP地址和物理地址的映射关系。

| 主机名称 |    IP地址     |      MAC地址      |
| :------: | :-----------: | :---------------: |
|    A     | 192.168.38.10 | 00-AA-00-62-D2-02 |
|    B     | 192.168.38.11 | 00-BB-00-62-C2-02 |
|    C     | 192.168.38.12 | 00-CC-00-62-C2-02 |
|    D     | 192.168.38.13 | 00-DD-00-62-C2-02 |
|    E     | 192.168.38.14 | 00-EE-00-62-C2-02 |

### 以主机A（192.168.38.10）向主机B（192.168.38.11）发送数据为例。

1. 当发送数据时，主机A会在自己的ARP缓存表中寻找是否有目标IP地址。如果找到就知道目标MAC地址为（00-BB-00-62-C2-02），直接把目标MAC地址写入[帧]里面发送就可。

2. 如果在ARP缓存表中没有找到相对应的IP地址，主机A就会在网络上发送一个广播（ARP request），广播中携带自己的主机名称，IP地址，物理地址 ，以及需要查询的IP地址”

3. 网络上其他主机接受到广播后，将广播中A主机的信息更新到自己的ARP缓存中。主机B接收到这个帧时，也将A的数据存入自己缓存中，并向主机A做出这样的回应（ARP response）：“192.168.38.11的MAC地址是00-BB-00-62-C2-02”，此回应以单播方式。这样，主机A就知道主机B的MAC地址，它就可以向主机B发送信息。

4. 下次再向主机B发送信息时，直接从ARP缓存表里查找就可。

### 生存时间

ARP高速缓存中的每一个映射地址都有一个生存时间，当时间结束之后，就重新发送该广播更新地址。保证数据的正确性。

## 7. IP数据报格式

![IP数据报](https://gitee.com/ShaoxiongDu/imageBed/raw/master/IP%E6%95%B0%E6%8D%AE%E6%8A%A5.png)

注 ：图中括号内为该部分的长度　单位：　位（bit）

### 版本 4bit
表示IP协议的版本，通信双方必须使用相同的IP协议版本。目前最广泛的是IPv4版本
### 首部长度 4bit
最大表示的十进制是2^4-1 即15 此字段的单位是4字节，也就是当此字段的值位1时，表示首部长度为1个4字节。当1111时，表示首部长度（15*4）= 60个字节

最常用的首部长度为20个字节，也就是此字段为0101

### 区分服务 8bit
服务类型，一般不使用
### 总长度 16bit
首部和数据部分之和，单位是字节。因此IP数据报的最大长度为2^16=65535字节
### 标识 16bit
每产生一个IP数据报，此字段+1，当IP数据报分片时，同一个IP数据报的分片此字段相同。
### 标志 3bit
- 最低位： MF： 有没有更多分片 =1表示还有分片 =0表示无分片
- 中间位： DF： 是不是不能分片 =1表示不能分片 =0表示能分片
### 片偏移 13bit
经过分片之后，此分片在原分组中的相对位置。

### 生存时间 8bit

TTL（Time To Live） 之前表示数据报在网络中的寿命  后来改为跳数限制，但名字没变。
路由器在转发之前，将该值-1，当为0时，丢弃此分组。
若该值为1，则表示该IP数据报只在本局域网传播。
### 协议 8bit

| 协议名 | 字段 |
| ------ | ---- |
| ICMP   | 1    |
| IGMP   | 2    |
| TCP    | 6    |
| EGP    | 8    |
| IGP    | 9    |
| UDP    | 17   |
| IPv6   | 41   |
| OSPF   | 89   |

### 首部检验和 16bit
检验数据报的首部，通过将首部划分为许多16位的序列，将该字段置0，反码运算把所有16位字相加，结果写入此字段。
接受方接受之后，将首部的16位反码运算相加，结果与此字段取反码，若数据无错，则结果为0；
### 可变部分
支持排错，测量及其安全措施。
### 填充字段

首部长度必须时4的整数倍，当不够时，用填充字段填充。

因此，数据部分总是在4字节的整数倍开始

## 8.ICMP协议详解 （待补充）


# 三.传输层/运输层详解

> 待开发

# 四.应用层详解

> 待开发

# 五.网络安全详解

> 待开发

